<br>
<br>
<br>

# S·ª≠ D·ª•ng C·∫£m Bi·∫øn Si√™u √Çm V·ªõi Zerobase

![ultrasonic-sensor-zerobase](https://cdn.chipstack.vn/zerobase/ultrasonic-sensor/ultrasonic-sensor-zerobase.jpg "ultrasonic-sensor-zerobase")

## T·ªïng quan

?> B√†i vi·∫øt n√†y h∆∞·ªõng d·∫´n s·ª≠ d·ª•ng c·∫£m bi·∫øn si√™u √¢m v·ªõi Zerobase ƒë·ªÉ ƒëo kho·∫£ng c√°ch v√† hi·ªÉn th·ªã k·∫øt qu·∫£ b·∫±ng c√°ch b·∫≠t/t·∫Øt d√£y LED. 

## Chu·∫©n B·ªã

| Linh ki·ªán |  Link mua |
| --- | --- |
| Board Zerobase | [Mua ngay](https://chipstack.vn/san-pham/zerobase/) |
| C·∫£m bi·∫øn si√™u √¢m | [Mua ngay](https://chipstack.vn/san-pham/cam-bien-sieu-am/) |
| ƒêi·ªán tr·ªü 330Œ© | [Mua ngay](https://chipstack.vn/san-pham/dien-tro-1-4w-1/) |
| LED | [Mua ngay](https://chipstack.vn/san-pham/led-5mm-vo-mau/) |
| D√¢y n·ªëi | [Mua ngay](https://chipstack.vn/san-pham/day-jumper-duc-duc/) |
| Breadboard | [Mua ngay](https://chipstack.vn/san-pham/breadboard-830-lo/) |
| D√¢y USB Type C | [Mua ngay](https://chipstack.vn/san-pham/day-usb-type-c-1m/) |

<br>

<div align="center">
    <img src="https://cdn.chipstack.vn/default/zerobase-overview.png" alt="zerobase">
    <p><em>Board Zerobase</em></p>
</div>

<br>

<div align="center">
    <img src="https://cdn.chipstack.vn/zerobase/ultrasonic-sensor/ultrasonic-sensor.png" alt="ultrasonic-sensor">
    <p><em>C·∫£m bi·∫øn si√™u √¢m</em></p>
</div>

<br>

<div align="center">
    <img src="https://cdn.chipstack.vn/default/dien-tro-330-ohm.png" alt="dien-tro-330-ohm">
    <p><em>ƒêi·ªán tr·ªü 330Œ©</em></p>
</div>

<br>

<div align="center">
    <img src="https://cdn.chipstack.vn/default/led-do.png" alt="led-do">
    <p><em>LED</em></p>
</div>

<br>

<div align="center">
    <img src="https://cdn.chipstack.vn/default/jumper-wire.png" alt="jumper-wire">
    <p><em>D√¢y n·ªëi</em></p>
</div>

<br>

<div align="center">
    <img src="https://cdn.chipstack.vn/default/breadboard.png" alt="breadboard">
    <p><em>Breadboard</em></p>
</div>

<br>

<div align="center">
    <img src="https://cdn.chipstack.vn/default/usb-type-c.jpg" alt="usb-type-c">
    <p><em>D√¢y USB Type C</em></p>
</div>

## Nguy√™n L√Ω Ho·∫°t ƒê·ªông

![ultrasonic-sensor-working-principle](https://cdn.chipstack.vn/zerobase/ultrasonic-sensor/ultrasonic-sensor-working-principle.png "ultrasonic-sensor-working-principle")

?> C·∫£m bi·∫øn si√™u √¢m ho·∫°t ƒë·ªông b·∫±ng c√°ch ph√°t ra m·ªôt xung si√™u √¢m t·ª´ ch√¢n Trig (TX) trong 10 micro gi√¢y. Sau khi ph√°t xung, ch√¢n Echo (RX) ƒë∆∞·ª£c k√©o l√™n m·ª©c cao v√† gi·ªØ nguy√™n cho ƒë·∫øn khi nh·∫≠n ƒë∆∞·ª£c t√≠n hi·ªáu ph·∫£n x·∫° t·ª´ v·∫≠t c·∫£n. Th·ªùi gian ch√¢n Echo gi·ªØ m·ª©c cao ch√≠nh l√† th·ªùi gian s√≥ng si√™u √¢m di chuy·ªÉn ƒë·∫øn v·∫≠t v√† quay v·ªÅ. D·ª±a v√†o ƒë√≥, vi ƒëi·ªÅu khi·ªÉn t√≠nh to√°n kho·∫£ng c√°ch b·∫±ng c√¥ng th·ª©c: `Kho·∫£ng c√°ch = (Th·ªùi¬†gian¬†Echo¬†√ó 0.034) / 2`. 

?> Sau khi ƒëo kho·∫£ng c√°ch, h·ªá th·ªëng s·∫Ω b·∫≠t s·ªë l∆∞·ª£ng ƒë√®n LED t∆∞∆°ng ·ª©ng: N·∫øu v·∫≠t ·ªü g·∫ßn, nhi·ªÅu ƒë√®n s√°ng l√™n; n·∫øu v·∫≠t ·ªü xa, √≠t ƒë√®n s√°ng h∆°n; n·∫øu kh√¥ng c√≥ v·∫≠t trong ph·∫°m vi ƒëo, t·∫•t c·∫£ ƒë√®n s·∫Ω t·∫Øt.

> Xem th√™m v·ªÅ LED [t·∫°i ƒë√¢y](https://chipstack.vn/uncategorized/diot-phat-quang-la-gi-nguyen-ly-hoat-dong-va-ung-dung-tiet-kiem-nang-luong/).

## S∆° ƒê·ªì K·∫øt N·ªëi

![ultrasonic-zerboase-pins](https://cdn.chipstack.vn/zerobase/ultrasonic-sensor/ultrasonic-zerobase-pins.png "ultrasonic-zerboase-pins")

S·ª≠ d·ª•ng ch√¢n A0 (D14), A1 (D15), A2 (D16), A3 (D17), SDA (D18) v√† D3 ƒë·ªÉ k·∫øt n·ªëi v·ªõi c√°c ch√¢n anode (+) c·ªßa LED, ch√¢n cathode (-) c·ªßa LED k·∫øt n·ªëi v·ªõi ƒëi·ªán tr·ªü 330Œ© v√† n·ªëi xu·ªëng GND c·ªßa Zerobase.

Ch√¢n Trig c·ªßa c·∫£m bi·∫øn si√™u √¢m k·∫øt n·ªëi v·ªõi ch√¢n MO (D11), ch√¢n Echo k·∫øt n·ªëi v·ªõi ch√¢n SS (D10).

S·ª≠ d·ª•ng ch√¢n GND v√† 5V ƒë·ªÉ c·∫•p ngu·ªìn cho c·∫£m bi·∫øn si√™u √¢m.

![ultrasonic-sensor-zerobase-schematic](https://cdn.chipstack.vn/zerobase/ultrasonic-sensor/ultrasonic-sensor-zerobase-schematic.png "ultrasonic-sensor-zerobase-schematic")

![ultrasonic-sensor-zerobase](https://cdn.chipstack.vn/zerobase/ultrasonic-sensor/ultrasonic-sensor-zerobase.jpg "ultrasonic-sensor-zerobase")

![ultrasonic-sensor-zerobase-mat-sau](https://cdn.chipstack.vn/zerobase/ultrasonic-sensor/ultrasonic-sensor-zerobase-mat-sau.jpg "ultrasonic-sensor-zerobase-mat-sau")

![ultrasonic-sensor-zerobase-mat-tren](https://cdn.chipstack.vn/zerobase/ultrasonic-sensor/ultrasonic-sensor-zerobase-mat-tren.jpg "ultrasonic-sensor-zerobase-mat-tren")

## Code

```cpp
const int ledPins[] = { 3, 18, 17, 16, 15, 14 };  // M·∫£ng ch·ª©a c√°c ch√¢n k·∫øt n·ªëi LED

const int numLeds = sizeof(ledPins) / sizeof(ledPins[0]);  // T√≠nh s·ªë l∆∞·ª£ng LED d·ª±a tr√™n k√≠ch th∆∞·ªõc m·∫£ng

const int trigPin = 11;  // Ch√¢n ph√°t t√≠n hi·ªáu c·ªßa c·∫£m bi·∫øn si√™u √¢m

const int echoPin = 10;  // Ch√¢n nh·∫≠n t√≠n hi·ªáu ph·∫£n h·ªìi c·ªßa c·∫£m bi·∫øn si√™u √¢m

const int distanceThreshold = 20;  // Ng∆∞·ª°ng kho·∫£ng c√°ch ƒë·ªÉ b·∫≠t LED

void setup() {
  pinMode(trigPin, OUTPUT);  // C·∫•u h√¨nh ch√¢n trigPin l√† OUTPUT
  pinMode(echoPin, INPUT);   // C·∫•u h√¨nh ch√¢n echoPin l√† INPUT

  for (int i = 0; i < numLeds; i++) {
    pinMode(ledPins[i], OUTPUT);  // Thi·∫øt l·∫≠p c√°c ch√¢n LED l√† OUTPUT
  }
}

long getDistance() {
  digitalWrite(trigPin, LOW);  // ƒê·∫£m b·∫£o t√≠n hi·ªáu b·∫Øt ƒë·∫ßu t·ª´ m·ª©c th·∫•p
  delayMicroseconds(2);        // Ch·ªù 2 micro gi√¢y ƒë·ªÉ ·ªïn ƒë·ªãnh

  digitalWrite(trigPin, HIGH);  // G·ª≠i xung t√≠n hi·ªáu k√©o d√†i 10 micro gi√¢y
  delayMicroseconds(10);
  digitalWrite(trigPin, LOW);  // K·∫øt th√∫c xung t√≠n hi·ªáu

  // ƒêo th·ªùi gian ph·∫£n h·ªìi t·ª´ c·∫£m bi·∫øn v√† t√≠nh to√°n kho·∫£ng c√°ch (cm)
  return pulseIn(echoPin, HIGH) * 0.034 / 2;
}

void loop() {
  long distance = getDistance();  // ƒê·ªçc kho·∫£ng c√°ch t·ª´ c·∫£m bi·∫øn si√™u √¢m

  if (distance <= distanceThreshold) {                             // N·∫øu kho·∫£ng c√°ch nh·ªè h∆°n ho·∫∑c b·∫±ng 20 cm
    int ledsOn = map(distance, 0, distanceThreshold, numLeds, 0);  // Chuy·ªÉn ƒë·ªïi kho·∫£ng c√°ch sang s·ªë LED c·∫ßn b·∫≠t
    ledsOn = constrain(ledsOn, 0, numLeds);         // Gi·ªõi h·∫°n gi√° tr·ªã trong kho·∫£ng h·ª£p l·ªá

    for (int i = 0; i < numLeds; i++) {
      digitalWrite(ledPins[i], i < ledsOn ? HIGH : LOW);  // B·∫≠t s·ªë LED t∆∞∆°ng ·ª©ng v·ªõi kho·∫£ng c√°ch
    }
    delay(100);  // Gi·ªØ tr·∫°ng th√°i LED trong 100ms
  }

  for (int i = 0; i < numLeds; i++) {
    digitalWrite(ledPins[i], LOW);  // T·∫Øt t·∫•t c·∫£ LED khi kh√¥ng c√≥ v·∫≠t trong ph·∫°m vi
  }
}
```
Copy ƒëo·∫°n code tr√™n v√† d√°n v√†o Arduino IDE, k·∫øt qu·∫£ s·∫Ω ƒë∆∞·ª£c nh∆∞ h√¨nh b√™n d∆∞·ªõi.

![ultrasonic-zerobase-code](https://cdn.chipstack.vn/zerobase/ultrasonic-sensor/ultrasonic-zerobase-code.png "ultrasonic-zerobase-code]")

### Bi√™n d·ªãch

Nh·∫•n v√†o bi·ªÉu t∆∞·ª£ng Verify ƒë·ªÉ bi√™n d·ªãch code.

![verify-code](https://cdn.chipstack.vn/default/verify-code.png "verify-code]")

### Th·ª±c Hi·ªán N·∫°p Code

Cu·ªëi c√πng b·∫°n th·ª±c hi·ªán n·∫°p code v√†o board Zerobase. N·∫øu ch∆∞a bi·∫øt c√°ch n·∫°p code cho Zerobase, b·∫°n c√≥ th·ªÉ tham kh·∫£o [t·∫°i ƒë√¢y](https://zerobase.chipstack.vn/#/vi/zerobase/quickstart).

N·∫øu mu·ªën thay ƒë·ªïi ch√¢n k·∫øt n·ªëi, b·∫°n ch·ªâ c·∫ßn s·ª≠a l·∫°i gi√° tr·ªã bi·∫øn `ledPins`, `trigPin` ho·∫∑c `echoPin` trong code sau ƒë√≥ k·∫øt n·ªëi LED v√† c·∫£m bi·∫øn si√™u √¢m v·ªõi ch√¢n t∆∞∆°ng ·ª©ng.

```cpp
const int ledPins[] = { 3, 18, 17, 16, 15, 14 };  // Thay ƒë·ªïi ch√¢n k·∫øt n·ªëi LED
const int trigPin = 11;  // Thay ƒë·ªïi ch√¢n k·∫øt n·ªëi Trig
const int echoPin = 10;  // Thay ƒë·ªïi ch√¢n k·∫øt n·ªëi Echo
```

N·∫øu mu·ªën thay ƒë·ªïi ng∆∞·ª°ng kho·∫£ng c√°ch ƒë·ªÉ b·∫≠t LED, b·∫°n ch·ªâ c·∫ßn s·ª≠a gi√° tr·ªã bi·∫øn `distanceThreshold`.

```cpp
const int distanceThreshold = 20;  // Thay ƒë·ªïi ng∆∞·ª°ng kho·∫£ng c√°ch ƒë·ªÉ b·∫≠t LED
```

### Gi·∫£i Th√≠ch Code

Khai b√°o m·∫£ng `ledPins` ch·ª©a c√°c ch√¢n k·∫øt n·ªëi LED.

```cpp
const int ledPins[] = { 3, 18, 17, 16, 15, 14 };
```
T√≠nh s·ªë l∆∞·ª£ng LED d·ª±a tr√™n k√≠ch th∆∞·ªõc m·∫£ng.

```cpp
const int numLeds = sizeof(ledPins) / sizeof(ledPins[0]);
```

Khai b√°o ch√¢n `trigPin` l√† ch√¢n ph√°t t√≠n hi·ªáu c·ªßa c·∫£m bi·∫øn si√™u √¢m v√† ch√¢n `echoPin` l√† ch√¢n nh·∫≠n t√≠n hi·ªáu ph·∫£n h·ªìi c·ªßa c·∫£m bi·∫øn si√™u √¢m.

```cpp
const int trigPin = 11;
const int echoPin = 10;
```

Khai b√°o ng∆∞·ª°ng kho·∫£ng c√°ch ƒë·ªÉ b·∫≠t LED.

```cpp
const int distanceThreshold = 20;  // Ng∆∞·ª°ng kho·∫£ng c√°ch ƒë·ªÉ b·∫≠t LED
```

C·∫•u h√¨nh ch√¢n `trigPin` l√† OUTPUT, ch√¢n `echoPin` l√† INPUT v√† c·∫•u h√¨nh c√°c ch√¢n LED l√† OUTPUT.

```cpp
  pinMode(trigPin, OUTPUT);
  pinMode(echoPin, INPUT);

  for (int i = 0; i < numLeds; i++) {
    pinMode(ledPins[i], OUTPUT);
  }
```

H√†m `getDistance()` d√πng ƒë·ªÉ ƒëo kho·∫£ng c√°ch t·ª´ c·∫£m bi·∫øn si√™u √¢m.

```cpp
long getDistance() {
  digitalWrite(trigPin, LOW);
  delayMicroseconds(2);

  digitalWrite(trigPin, HIGH);
  delayMicroseconds(10);
  digitalWrite(trigPin, LOW);

  return pulseIn(echoPin, HIGH) * 0.034 / 2;
}
```

ƒê·ªçc kho·∫£ng c√°ch t·ª´ c·∫£m bi·∫øn si√™u √¢m.

```cpp
  long distance = getDistance();
```

N·∫øu kho·∫£ng c√°ch nh·ªè h∆°n ho·∫∑c b·∫±ng 20 cm:
- H√†m map(value, fromLow, fromHigh, toLow, toHigh) d√πng ƒë·ªÉ √°nh x·∫° gi√° tr·ªã t·ª´ m·ªôt kho·∫£ng sang m·ªôt kho·∫£ng kh√°c.
- ·ªû ƒë√¢y, distance (kho·∫£ng c√°ch ƒëo ƒë∆∞·ª£c) n·∫±m trong kho·∫£ng 0-32 cm s·∫Ω ƒë∆∞·ª£c √°nh x·∫° sang s·ªë LED c·∫ßn b·∫≠t t·ª´ numLeds (6) ƒë·∫øn 0.
- Khi distance = 0 cm (v·∫≠t r·∫•t g·∫ßn), t·∫•t c·∫£ numLeds LED (6 LED) s·∫Ω s√°ng.
- Khi distance = 32 cm (xa h∆°n gi·ªõi h·∫°n), 0 LED s√°ng.

- H√†m constrain(value, min, max) d√πng ƒë·ªÉ gi·ªõi h·∫°n gi√° tr·ªã trong m·ªôt kho·∫£ng h·ª£p l·ªá.
- ·ªû ƒë√¢y, gi√° tr·ªã ledsOn s·∫Ω ƒë∆∞·ª£c gi·ªõi h·∫°n trong kho·∫£ng 0-6.

D√πng v√≤ng l·∫∑p ƒë·ªÉ b·∫≠t s·ªë LED t∆∞∆°ng ·ª©ng v·ªõi kho·∫£ng c√°ch:
- N·∫øu LED th·ª© i nh·ªè h∆°n s·ªë LED c·∫ßn b·∫≠t, b·∫≠t LED th·ª© i, ng∆∞·ª£c l·∫°i t·∫Øt LED th·ª© i.

```cpp
  if (distance <= distanceThreshold) {
    int ledsOn = map(distance, 0, distanceThreshold, numLeds, 0);
    ledsOn = constrain(ledsOn, 0, numLeds);

    for (int i = 0; i < numLeds; i++) {
      digitalWrite(ledPins[i], i < ledsOn ? HIGH : LOW);
    }
    delay(100);
  }
```

T·∫Øt t·∫•t c·∫£ LED khi kh√¥ng c√≥ v·∫≠t trong ph·∫°m vi 20 cm.

```cpp
  for (int i = 0; i < numLeds; i++) {
    digitalWrite(ledPins[i], LOW);
  }
```

## K·∫øt qu·∫£

?> Khi c√≥ v·∫≠t ·ªü g·∫ßn, nhi·ªÅu LED s√°ng h∆°n, v√† khi v·∫≠t ·ªü xa, √≠t LED s√°ng h∆°n. Khi kh√¥ng c√≥ v·∫≠t trong ph·∫°m vi 20 cm, t·∫•t c·∫£ LED s·∫Ω t·∫Øt.

<p align="center">
  <img src="https://cdn.chipstack.vn/zerobase/ultrasonic-sensor/ultrasonic-sensor-zerobase-result.gif" alt="ultrasonic-sensor-zerobase-result">
</p>

## K·∫øt Lu·∫≠n v√† H∆∞·ªõng Ph√°t Tri·ªÉn

B√†i vi·∫øt ƒë√£ h∆∞·ªõng d·∫´n c√°ch s·ª≠ d·ª•ng c·∫£m bi·∫øn si√™u √¢m v·ªõi Zerobase ƒë·ªÉ ƒëo kho·∫£ng c√°ch v√† hi·ªÉn th·ªã k·∫øt qu·∫£ b·∫±ng c√°ch b·∫≠t/t·∫Øt d√£y LED.

ƒê·ªÉ ph√°t tri·ªÉn th√™m t·ª´ b√†i h·ªçc n√†y, b·∫°n c√≥ th·ªÉ th·ª≠ c√°c √Ω t∆∞·ªüng sau:
- Hi·ªÉn th·ªã kho·∫£ng c√°ch tr√™n m√†n h√¨nh LCD/OLED: Thay v√¨ ch·ªâ d√πng LED, b·∫°n c√≥ th·ªÉ k·∫øt h·ª£p m√†n h√¨nh ƒë·ªÉ hi·ªÉn th·ªã ch√≠nh x√°c kho·∫£ng c√°ch ƒëo ƒë∆∞·ª£c.
- C·∫£nh b√°o b·∫±ng √¢m thanh: Th√™m c√≤i buzzer ƒë·ªÉ ph√°t √¢m thanh khi v·∫≠t ƒë·∫øn g·∫ßn m·ªôt m·ª©c nguy hi·ªÉm.
- ƒêi·ªÅu khi·ªÉn ƒë·ªông c∆°: ·ª®ng d·ª•ng v√†o robot tr√°nh v·∫≠t c·∫£n b·∫±ng c√°ch s·ª≠ d·ª•ng kho·∫£ng c√°ch ƒëo ƒë∆∞·ª£c ƒë·ªÉ thay ƒë·ªïi h∆∞·ªõng di chuy·ªÉn.
- K·∫øt n·ªëi v·ªõi IoT: G·ª≠i d·ªØ li·ªáu kho·∫£ng c√°ch l√™n m·ªôt h·ªá th·ªëng IoT ƒë·ªÉ gi√°m s√°t t·ª´ xa.

**Ch√∫c b·∫°n th√†nh c√¥ng!** 

[üè† TR·ªû V·ªÄ TRANG T·ªîNG H·ª¢P C√ÅC V√ç D·ª§](vi/zerobase/examples.md)</span>